@page "/login/{target:alpha}"
@using ComwellApp.Services
@using ComwellApp.Services.Login
@inject NavigationManager navManager
@inject ILoginService loginService
<div class="login-page-background">
    <div class="login-container">
        <h3>Login</h3>

        <div class="form-group">
            <label>Email-Addresse</label>
            <InputText class="form-control" @bind-Value="Email" placeholder="mail@mail.com"/>
        </div>
        <div class="form-group">
            <label>Adgangskode</label>
            <InputText class="form-control" type="password" @bind-Value="Adgangskode" placeholder="Adgangskode"/>
        </div>
        <div class="form-group mt-2">
            <button class="btn btn-primary" @onclick="OnClickLogin">Login</button>
        </div>
        @if (!string.IsNullOrEmpty(errorText))
        {
            <div class="error-message">
                <span class="error-icon">⚠️</span>
                <span class="error-text">@errorText</span>
            </div>
        }
    </div>
</div>
@code {
    string Email = "";
    string Adgangskode = "";
    string errorText = "";

    [Parameter] public string target { get; set; }

    private async Task OnClickLogin()
    {
        var succes = await loginService.Login(Email, Adgangskode);
        if (!succes)
        {
            errorText = "Forkert email eller adgangskode, vær venlig og prøve igen";
        }
        else
        {
            navManager.NavigateTo(target, forceLoad: true);
        }
    }
}