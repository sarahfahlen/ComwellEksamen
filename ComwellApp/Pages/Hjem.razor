@page "/"                  
@page "/hjem"

@inject ILoginService lService         
@inject NavigationManager navManager   

@using ComwellApp.Services.Login       
@using Shared                          

<PageTitle>Hjem</PageTitle>            

<div class="page-wrapper hjem-baggrund">
    
    <!-- Viser navnet på den loggede bruger -->
    <h3 class="overskrift">Velkommen, @loggedIn?.Navn</h3>

    <div class="intro-container">
        <p class="intro-text">
            Her kan du få et hurtigt overblik over dine læringsmål, kommende deadlines og vigtig praktisk information.
            Klik på boksene for at dykke ned i indholdet og finde relevante kontaktoplysninger, hvis du har brug for hjælp.
        </p>
    </div>

    <div class="dashboard-box-container">
        <div class="dashboard-box">
            <h4>Kommende Deadlines</h4>
            <!-- Indhold tilføjes senere -->
        </div>

        <div class="dashboard-box klikbarsted">
            <h4>Learning Module</h4>
            <!-- Også tom for nu -->
        </div>

        <div class="dashboard-box klikbarsted" @onclick="ÅbenModal">
            <!-- Åbner modal med praktisk info -->
            <h4>Praktisk Info</h4>
            <p>Klik her for kontaktoplysninger</p>
        </div>
    </div>
</div>

@if (visModal)
{
    <!-- Modal vises kun hvis brugeren har klikket -->
    <div class="modal-overlay" @onclick="LukModal">
        <div class="modal-content" @onclick:stopPropagation>
            <h5>Kontaktoplysninger</h5>
            <ul>
                <li><strong>Køkkenchef:</strong> Theis Christensen – 12 34 56 78</li>
                <li><strong>HR:</strong> Jane Mayes Harkes – 23 45 67 89</li>
                <li><strong>Hvis du er syg:</strong> Ring til SOV – 98 76 54 32</li>
                <li><strong>Adresse:</strong> Comwell Vej 12, 8000 Aarhus</li>
            </ul>
            <button class="btn btn-secondary mt-3" @onclick="LukModal">Luk</button>
        </div>
    </div>
}

@code {
    // Her gemmer vi den bruger der er logget ind
    private Bruger? loggedIn;     
    
    // Styrer om modalen (kontaktinfo) vises eller ej
    private bool visModal = false;    

    // Denne metode kaldes automatisk når siden indlæses
    protected override async Task OnInitializedAsync()
    {
        // Henter den bruger som er logget ind (fra lokal storage via service)
        loggedIn = await lService.GetUserLoggedIn();

        // Hvis ingen bruger er logget ind, sendes de til login-siden
        if (loggedIn == null)
        {
            navManager.NavigateTo("login/hjem");
            return;
        }
    }

    // Når brugeren klikker på "Praktisk info", vis modal
    private void ÅbenModal()
    {
        visModal = true;
    }

    // Når brugeren klikker udenfor modal, eller på "Luk", skjul modal
    private void LukModal()
    {
        visModal = false;
    }
}

